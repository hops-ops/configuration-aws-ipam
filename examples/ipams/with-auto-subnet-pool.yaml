# IPAM with automatic child subnet pool (subnetPool.enabled pattern)
# Creates a VPC pool with an auto-generated child subnet pool named "${poolName}-subnets"
#
# This is the simpler automatic approach - for the manual array approach,
# see example-with-subnet-pool.yaml
apiVersion: aws.hops.ops.com.ai/v1alpha1
kind: IPAM
metadata:
  name: platform
  namespace: infra
spec:
  scope: private
  homeRegion: us-east-1
  pools:
    # Parent pool for VPC allocations with automatic subnet pool
    - name: sandbox
      cidr: "10.0.0.0/8"
      allocationDefaultNetmaskLength: 16
      allocationMinNetmaskLength: 16
      allocationMaxNetmaskLength: 20
      labels:
        hops.ops.com.ai/global-pool: sandbox
      # Enable automatic subnet pool creation
      subnetPool:
        enabled: true
        allocationDefaultNetmaskLength: 24
        allocationMinNetmaskLength: 20
        allocationMaxNetmaskLength: 28
